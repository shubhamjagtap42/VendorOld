<div *ngIf="loadView">
  <p for="Back button" class="header-back-button" (click)="onClickBack()">
    <i class="pi pi-chevron-left"></i>
    {{ templateDescription.name }}
  </p>
  <form [formGroup]="productsForm" autocomplete="off">
    <div
      class="template-form"
      formArrayName="category"
      class="container-with-scrollbar"
    >
      <table class="now-wrap" style="width: 100%">
        <thead>
          <tr>
            <table>
              <tr>
                <th class="header">Category</th>
                <th class="weightage">Weightage</th>
                <table style="width: 100%">
                  <tr>
                    <th class="header">Primary Sub-Category</th>
                    <th class="weightage">Weightage</th>

                    <table style="width: 100%">
                      <tr>
                        <th class="header">Secondary Sub-Category</th>
                        <th class="weightage">Weightage</th>
                        <table style="width: 100%">
                          <tr>
                            <th class="header">Tertiary Sub-Category</th>
                            <th class="weightage">Weightage</th>
                            <table style="width: 100%">
                              <tr>
                                <th class="header">Parameter</th>
                                <th class="weightage">Weightage</th>
                                <th class="weightage">Max Score</th>
                                <th class="header">Scoring Criteria</th>
                              </tr>
                            </table>
                          </tr>
                        </table>
                      </tr>
                    </table>
                  </tr>
                </table>
              </tr>
            </table>
          </tr>
        </thead>
        <tbody class="table1">
          <table>
            <tr
              *ngFor="
                let category of getCategoryControls().controls;
                let i = index
              "
            >
              <p-accordion>
                <p-accordionTab [selected]="true">
                  <ng-template pTemplate="header">
                    <div class="header1">
                      {{ category.value.name }} ({{ category.value.weightage }})
                    </div>
                  </ng-template>
                  <div style="width: auto; overflow: auto; height: 20rem">
                    <table>
                      <tr>
                        <div [formGroupName]="i" class="display">
                          <td>
                            <p-cascadeSelect
                              styleClass="cascadeDropdown"
                              [showClear]="true"
                              id="username"
                              formControlName="name"
                              [options]="categoriesData"
                              optionLabel="name"
                              optionValue="name"
                              optionGroupLabel="name"
                              [optionGroupChildren]="['states', 'cities']"
                              [style]="{ width: '14rem', height: '40px' }"
                              placeholder="Select"
                              appendTo="body"
                            ></p-cascadeSelect>
                            <p>
                              <mat-error
                                *ngIf="(
                    getCategoryControls()?.at(i)?.dirty ||
                    getCategoryControls()?.at(i)?.touched
                 ) &&
                 getCategoryControls()?.at(i)?.errors?.['categoryError']"
                              >
                                Duplicate category name is not allowed
                              </mat-error>
                            </p>
                            <button
                              class="bottun-align"
                              mat-icon-button
                              [matMenuTriggerFor]="cat"
                              aria-label="Example icon-button with a menu"
                            >
                              <mat-icon>more_vert</mat-icon>
                            </button>
                            <!-- <button type="button" (click)="addCategory()">Add Category</button>
                <button type="button" (click)="removeCategory(i)">Remove Category</button> -->
                            <mat-menu #cat="matMenu">
                              <button
                                mat-menu-item
                                (click)="onSearchOption('category', i)"
                              >
                                <mat-icon>search</mat-icon>
                                <span>Search Category</span>
                              </button>
                              <button
                                mat-menu-item
                                (click)="onEditOption('category', i)"
                              >
                                <mat-icon>edit</mat-icon>
                                <span>Add Custom Category</span>
                              </button>
                              <button
                                mat-menu-item
                                (click)="addSingleCategory()"
                              >
                                <mat-icon>add</mat-icon>
                                <span>Add New Category</span>
                              </button>
                              <button
                                mat-menu-item
                                (click)="initCombine(i, 'category')"
                              >
                                <mat-icon>merge_type</mat-icon>
                                <span>Combine with</span>
                              </button>
                            </mat-menu>
                          </td>
                          <td>
                            <input
                              pInputText
                              type="number"
                              class="form-control weightage"
                              (change)="validateWeightage(i, 'category')"
                              formControlName="weightage"
                            />
                            <p>
                              <mat-error
                                *ngIf="(
                    getCategoryControls()?.at(i)?.dirty ||
                    getCategoryControls()?.at(i)?.touched
                 ) &&
                 getCategoryControls()?.at(i)?.errors?.['weightageError']"
                              >
                                Weightage addition should be 100
                              </mat-error>
                            </p>
                          </td>
                          <!-- subcategory Start-->
                          <div formArrayName="subcategory">
                            <table>
                              <tr
                                *ngFor="
                                  let subCategory of getSubCategoryControls(i)
                                    .controls;
                                  let j = index
                                "
                              >
                                <div [formGroupName]="j" class="display">
                                  <td>
                                    <p-cascadeSelect
                                      [showClear]="true"
                                      styleClass="cascadeDropdown"
                                      [style]="{ width: '14rem' }"
                                      id="subcategoryname"
                                      formControlName="subcategoryname"
                                      [options]="categoriesData"
                                      optionLabel="name"
                                      optionValue="name"
                                      optionGroupLabel="name"
                                      [optionGroupChildren]="[
                                        'states',
                                        'cities'
                                      ]"
                                      placeholder="Select"
                                      appendTo="body"
                                    >
                                    </p-cascadeSelect>
                                    <p>
                                      <mat-error
                                        *ngIf="(
                          getSubCategoryControls(i)?.at(j)?.dirty ||
                          getSubCategoryControls(i)?.at(j)?.touched
                       ) &&
                       getSubCategoryControls(i)?.at(j)?.errors?.['subCategoryError']"
                                      >
                                        Duplicate subcategory name is not
                                        allowed</mat-error
                                      >
                                    </p>
                                    <button
                                      class="bottun-align"
                                      mat-icon-button
                                      [matMenuTriggerFor]="sub"
                                      aria-label="Example icon-button with a menu"
                                    >
                                      <mat-icon>more_vert</mat-icon>
                                    </button>
                                    <mat-menu #sub="matMenu">
                                      <button
                                        mat-menu-item
                                        (click)="
                                          onSearchOption('subCategory', i, j)
                                        "
                                      >
                                        <mat-icon>search</mat-icon>
                                        <span>Search Sub-Category</span>
                                      </button>
                                      <button
                                        mat-menu-item
                                        (click)="
                                          onEditOption('subCategory', i, j)
                                        "
                                      >
                                        <mat-icon>edit</mat-icon>
                                        <span>Add Custom Sub-Category</span>
                                      </button>
                                      <button
                                        mat-menu-item
                                        (click)="addSubCategory(i)"
                                      >
                                        <mat-icon>add</mat-icon>
                                        <span>Add New Sub-Category</span>
                                      </button>
                                      <button
                                        mat-menu-item
                                        (click)="
                                          initCombine(i, 'subCategory', j)
                                        "
                                      >
                                        <mat-icon>merge_type</mat-icon>
                                        <span>Combine with</span>
                                      </button>
                                      <button
                                        [disabled]="
                                          getSubCategoryControls(i).length == 1
                                            ? true
                                            : false
                                        "
                                        mat-menu-item
                                        (click)="removeSubCategory(i, j)"
                                      >
                                        <mat-icon>delete</mat-icon>
                                        <span>Remove Sub-Category</span>
                                      </button>
                                    </mat-menu>
                                    <!-- <button type="button" (click)="addSubCategory(i)">Add Sub Category</button>
                    <button type="button" (click)="removeSubCategory(i,j)">Remove Sub Category</button> -->
                                  </td>
                                  <td>
                                    <input
                                      pInputText
                                      type="number"
                                      class="form-control weightage"
                                      (change)="
                                        validateWeightage(i, 'subCategory')
                                      "
                                      formControlName="weightage"
                                    />
                                    <p>
                                      <mat-error
                                        *ngIf="(
                          getSubCategoryControls(i)?.at(j)?.dirty ||
                          getSubCategoryControls(i)?.at(j)?.touched
                         ) &&
                         getSubCategoryControls(i)?.at(j)?.errors?.['weightageError']"
                                      >
                                        Weightage addition should be 100
                                      </mat-error>
                                    </p>
                                  </td>
                                  <!-- subcategoryTwo Start -->
                                  <div formArrayName="subcategoryTwo">
                                    <table>
                                      <tr
                                        *ngFor="
                                          let subCategoryTwo of getSubCategoryTwoControls(
                                            i,
                                            j
                                          ).controls;
                                          let k = index
                                        "
                                      >
                                        <div
                                          [formGroupName]="k"
                                          class="display"
                                        >
                                          <td>
                                            <p-cascadeSelect
                                              [showClear]="true"
                                              styleClass="cascadeDropdown"
                                              [style]="{ width: '14rem' }"
                                              id="subcategoryname"
                                              formControlName="subcategoryname"
                                              [options]="categoriesData"
                                              optionLabel="name"
                                              optionValue="name"
                                              optionGroupLabel="name"
                                              [optionGroupChildren]="[
                                                'states',
                                                'cities'
                                              ]"
                                              placeholder="Select"
                                              appendTo="body"
                                            >
                                            </p-cascadeSelect>
                                            <p>
                                              <!-- <mat-error> Duplicate subcategory name is not allowed</mat-error> -->
                                            </p>
                                            <button
                                              class="bottun-align"
                                              mat-icon-button
                                              [matMenuTriggerFor]="subCatTwo"
                                              aria-label="Example icon-button with a menu"
                                            >
                                              <mat-icon>more_vert</mat-icon>
                                            </button>
                                            <mat-menu #subCatTwo="matMenu">
                                              <button
                                                mat-menu-item
                                                (click)="
                                                  onSearchOption(
                                                    'subCategoryTwo',
                                                    i,
                                                    j,
                                                    k
                                                  )
                                                "
                                              >
                                                <mat-icon>search</mat-icon>
                                                <span
                                                  >Search Secondary
                                                  Sub-Category</span
                                                >
                                              </button>
                                              <button
                                                mat-menu-item
                                                (click)="
                                                  onEditOption(
                                                    'subCategoryTwo',
                                                    i,
                                                    j,
                                                    k
                                                  )
                                                "
                                              >
                                                <mat-icon>edit</mat-icon>
                                                <span
                                                  >Add Custom Secondary
                                                  Sub-Category</span
                                                >
                                              </button>
                                              <button
                                                mat-menu-item
                                                (click)="
                                                  addSubCategoryTwo(i, j)
                                                "
                                              >
                                                <mat-icon>add</mat-icon>
                                                <span
                                                  >Add New Secondary
                                                  Sub-Category</span
                                                >
                                              </button>
                                              <button
                                                mat-menu-item
                                                (click)="
                                                  initCombine(
                                                    i,
                                                    'subCategoryTwo',
                                                    j,
                                                    k
                                                  )
                                                "
                                              >
                                                <mat-icon>merge_type</mat-icon>
                                                <span>Combine with</span>
                                              </button>
                                              <button
                                                [disabled]="
                                                  getSubCategoryTwoControls(
                                                    i,
                                                    j
                                                  ).length == 1
                                                    ? true
                                                    : false
                                                "
                                                mat-menu-item
                                                (click)="
                                                  removeSubCategoryTwo(i, j, k)
                                                "
                                              >
                                                <mat-icon>delete</mat-icon>
                                                <span
                                                  >Remove Secondary
                                                  Sub-Category</span
                                                >
                                              </button>
                                            </mat-menu>
                                            <!-- <button type="button" (click)="addSubCategory(i)">Add Sub Category</button>
                            <button type="button" (click)="removeSubCategory(i,j)">Remove Sub Category</button> -->
                                          </td>
                                          <td>
                                            <input
                                              pInputText
                                              type="number"
                                              class="form-control weightage"
                                              (change)="
                                                validateWeightage(
                                                  i,
                                                  'subCategoryTwo',
                                                  j
                                                )
                                              "
                                              formControlName="weightage"
                                            />
                                            <p>
                                              <mat-error
                                                *ngIf="(
                                  getSubCategoryTwoControls(i,j)?.at(k)?.dirty ||
                                  getSubCategoryTwoControls(i,j)?.at(k)?.touched
                                 ) &&
                                 getSubCategoryTwoControls(i,j)?.at(k)?.errors?.['weightageError']"
                                              >
                                                Weightage addition should be 100
                                              </mat-error>
                                            </p>
                                          </td>
                                          <!-- Start subcategoryThree -->
                                          <div formArrayName="subcategoryThree">
                                            <table>
                                              <tr
                                                *ngFor="
                                                  let subCategoryThree of getSubCategoryThreeControls(
                                                    i,
                                                    j,
                                                    k
                                                  ).controls;
                                                  let l = index
                                                "
                                              >
                                                <div
                                                  [formGroupName]="l"
                                                  class="display"
                                                >
                                                  <td>
                                                    <p-cascadeSelect
                                                      [showClear]="true"
                                                      [style]="{
                                                        width: '14rem'
                                                      }"
                                                      id="subcategoryname"
                                                      formControlName="subcategoryname"
                                                      [options]="categoriesData"
                                                      optionLabel="name"
                                                      optionValue="name"
                                                      optionGroupLabel="name"
                                                      [optionGroupChildren]="[
                                                        'states',
                                                        'cities'
                                                      ]"
                                                      placeholder="Select"
                                                      appendTo="body"
                                                    >
                                                    </p-cascadeSelect>
                                                    <p>
                                                      <!-- <mat-error> Duplicate subcategory name is not allowed</mat-error> -->
                                                    </p>
                                                    <button
                                                      class="bottun-align"
                                                      mat-icon-button
                                                      [matMenuTriggerFor]="
                                                        subCatThree
                                                      "
                                                      aria-label="Example icon-button with a menu"
                                                    >
                                                      <mat-icon
                                                        >more_vert</mat-icon
                                                      >
                                                    </button>
                                                    <mat-menu
                                                      #subCatThree="matMenu"
                                                    >
                                                      <button
                                                        mat-menu-item
                                                        (click)="
                                                          onSearchOption(
                                                            'subCategoryThree',
                                                            i,
                                                            j,
                                                            k,
                                                            l
                                                          )
                                                        "
                                                      >
                                                        <mat-icon
                                                          >search</mat-icon
                                                        >
                                                        <span
                                                          >Search Tertiary
                                                          Sub-Category</span
                                                        >
                                                      </button>
                                                      <button
                                                        mat-menu-item
                                                        (click)="
                                                          onEditOption(
                                                            'subCategoryThree',
                                                            i,
                                                            j,
                                                            k,
                                                            l
                                                          )
                                                        "
                                                      >
                                                        <mat-icon
                                                          >edit</mat-icon
                                                        >
                                                        <span
                                                          >Add Custom Tertiary
                                                          Sub-Category</span
                                                        >
                                                      </button>
                                                      <button
                                                        mat-menu-item
                                                        (click)="
                                                          addSubCategoryThree(
                                                            i,
                                                            j,
                                                            k
                                                          )
                                                        "
                                                      >
                                                        <mat-icon>add</mat-icon>
                                                        <span
                                                          >Add new Tertiary
                                                          Sub-Category</span
                                                        >
                                                      </button>
                                                      <button
                                                        mat-menu-item
                                                        (click)="
                                                          initCombine(
                                                            i,
                                                            'subCategoryThree',
                                                            j,
                                                            k,
                                                            l
                                                          )
                                                        "
                                                      >
                                                        <mat-icon
                                                          >merge_type</mat-icon
                                                        >
                                                        <span
                                                          >Combine Tertiary
                                                          Sub-Category</span
                                                        >
                                                      </button>
                                                      <button
                                                        [disabled]="
                                                          getSubCategoryThreeControls(
                                                            i,
                                                            j,
                                                            k
                                                          ).length == 1
                                                            ? true
                                                            : false
                                                        "
                                                        mat-menu-item
                                                        (click)="
                                                          removeSubCategoryThree(
                                                            i,
                                                            j,
                                                            k,
                                                            l
                                                          )
                                                        "
                                                      >
                                                        <mat-icon
                                                          >delete</mat-icon
                                                        >
                                                        <span
                                                          >Remove Tertiary
                                                          Sub-Category</span
                                                        >
                                                      </button>
                                                    </mat-menu>
                                                    <!-- <button type="button" (click)="addSubCategory(i)">Add Sub Category</button>
                                      <button type="button" (click)="removeSubCategory(i,j)">Remove Sub Category</button> -->
                                                  </td>
                                                  <td>
                                                    <input
                                                      pInputText
                                                      type="number"
                                                      class="form-control weightage"
                                                      (change)="
                                                        validateWeightage(
                                                          i,
                                                          'subCategoryThree',
                                                          j,
                                                          k
                                                        )
                                                      "
                                                      formControlName="weightage"
                                                    />
                                                    <p>
                                                      <mat-error
                                                        *ngIf="(
                                            getSubCategoryThreeControls(i,j,k)?.at(l)?.dirty ||
                                            getSubCategoryThreeControls(i,j,k)?.at(l)?.touched
                                           ) &&
                                           getSubCategoryThreeControls(i,j,k)?.at(l)?.errors?.['weightageError']"
                                                      >
                                                        Weightage addition
                                                        should be 100
                                                      </mat-error>
                                                    </p>
                                                  </td>
                                                  <!-- parameter Start-->
                                                  <div
                                                    formArrayName="parameter"
                                                  >
                                                    <table>
                                                      <tr
                                                        *ngFor="
                                                          let subCategory of getParameterControls(
                                                            i,
                                                            j,
                                                            k,
                                                            l
                                                          ).controls;
                                                          let m = index
                                                        "
                                                      >
                                                        <div
                                                          [formGroupName]="m"
                                                        >
                                                          <td>
                                                            <p-cascadeSelect
                                                              [showClear]="true"
                                                              [style]="{
                                                                width: '14rem'
                                                              }"
                                                              id="parametername"
                                                              formControlName="parametername"
                                                              [options]="
                                                                categoriesData
                                                              "
                                                              optionLabel="name"
                                                              optionValue="name"
                                                              optionGroupLabel="name"
                                                              [optionGroupChildren]="[
                                                                'states',
                                                                'cities'
                                                              ]"
                                                              placeholder="Select"
                                                              appendTo="body"
                                                            >
                                                            </p-cascadeSelect>
                                                            <p>
                                                              <mat-error
                                                                *ngIf="(
                                                      getParameterControls(i,j,k,l)?.at(m)?.dirty ||
                                                      getParameterControls(i,j,k,l)?.at(m)?.touched
                                                   ) &&
                                                   getParameterControls(i,j,k,l)?.at(m)?.errors?.['parameterError']"
                                                              >
                                                                Duplicate
                                                                parameter name
                                                                is not
                                                                allowed</mat-error
                                                              >
                                                            </p>
                                                            <button
                                                              class="bottun-align"
                                                              mat-icon-button
                                                              [matMenuTriggerFor]="
                                                                para
                                                              "
                                                              aria-label="Example icon-button with a menu"
                                                            >
                                                              <mat-icon
                                                                >more_vert</mat-icon
                                                              >
                                                            </button>
                                                            <mat-menu
                                                              #para="matMenu"
                                                            >
                                                              <button
                                                                mat-menu-item
                                                                (click)="
                                                                  onSearchOption(
                                                                    'parameter',
                                                                    i,
                                                                    j,
                                                                    k,
                                                                    l,
                                                                    m
                                                                  )
                                                                "
                                                              >
                                                                <mat-icon
                                                                  >search</mat-icon
                                                                >
                                                                <span
                                                                  >Search
                                                                  Parameter</span
                                                                >
                                                              </button>
                                                              <button
                                                                mat-menu-item
                                                                (click)="
                                                                  onEditOption(
                                                                    'parameter',
                                                                    i,
                                                                    j,
                                                                    k,
                                                                    l,
                                                                    m
                                                                  )
                                                                "
                                                              >
                                                                <mat-icon
                                                                  >edit</mat-icon
                                                                >
                                                                <span
                                                                  >Add Custom
                                                                  Parameter</span
                                                                >
                                                              </button>
                                                              <button
                                                                mat-menu-item
                                                                (click)="
                                                                  addParameter(
                                                                    i,
                                                                    j,
                                                                    k,
                                                                    l
                                                                  )
                                                                "
                                                              >
                                                                <mat-icon
                                                                  >add</mat-icon
                                                                >
                                                                <span
                                                                  >Add New
                                                                  Parameter</span
                                                                >
                                                              </button>
                                                              <button
                                                                mat-menu-item
                                                                (click)="
                                                                  initCombine(
                                                                    i,
                                                                    'parameter',
                                                                    j,
                                                                    k,
                                                                    l,
                                                                    m
                                                                  )
                                                                "
                                                              >
                                                                <mat-icon
                                                                  >merge_type</mat-icon
                                                                >
                                                                <span
                                                                  >Move to
                                                                  Existing
                                                                  Subcategory</span
                                                                >
                                                              </button>
                                                              <button
                                                                [disabled]="
                                                                  getParameterControls(
                                                                    i,
                                                                    j,
                                                                    k,
                                                                    l
                                                                  ).length == 1
                                                                    ? true
                                                                    : false
                                                                "
                                                                mat-menu-item
                                                                (click)="
                                                                  removeParameter(
                                                                    i,
                                                                    j,
                                                                    k,
                                                                    l,
                                                                    m
                                                                  )
                                                                "
                                                              >
                                                                <mat-icon
                                                                  >delete</mat-icon
                                                                >
                                                                <span
                                                                  >Delete</span
                                                                >
                                                              </button>
                                                            </mat-menu>
                                                          </td>
                                                          <td>
                                                            <input
                                                              pInputText
                                                              type="number"
                                                              class="form-control weightage"
                                                              (change)="
                                                                validateWeightage(
                                                                  i,
                                                                  'parameter',
                                                                  j,
                                                                  k,
                                                                  l
                                                                )
                                                              "
                                                              formControlName="weightage"
                                                            />
                                                            <p>
                                                              <mat-error
                                                                *ngIf="(
                                                    getParameterControls(i,j,k,l)?.at(m)?.dirty ||
                                                    getParameterControls(i,j,k,l)?.at(m)?.touched
                                                   ) &&
                                                   getParameterControls(i,j,k,l)?.at(m)?.errors?.['weightageError']"
                                                              >
                                                                Weightage
                                                                addition should
                                                                be 100
                                                              </mat-error>
                                                            </p>
                                                          </td>
                                                          <td>
                                                            <input
                                                              pInputText
                                                              type="number"
                                                              class="form-control weightage"
                                                              id="maxschore"
                                                              formControlName="maxschore"
                                                              required
                                                            />
                                                          </td>

                                                          <td>
                                                            <div
                                                              formArrayName="schoringcriteria"
                                                            >
                                                              <table>
                                                                <tr
                                                                  *ngFor="
                                                                    let scoringCriteria of getScoringCriteriaControls(
                                                                      i,
                                                                      j,
                                                                      k,
                                                                      l,
                                                                      m
                                                                    ).controls;
                                                                    let n = index
                                                                  "
                                                                >
                                                                  <div
                                                                    [formGroupName]="
                                                                      n
                                                                    "
                                                                  >
                                                                    <td>
                                                                      <input
                                                                        pInputText
                                                                        type="text"
                                                                        class="form-control header"
                                                                        id="criteriaValue"
                                                                        formControlName="criteriaValue"
                                                                        required
                                                                      />
                                                                    </td>
                                                                    <td>
                                                                      <button
                                                                        class="bottun-align"
                                                                        mat-icon-button
                                                                        [matMenuTriggerFor]="
                                                                          maxScore
                                                                        "
                                                                        aria-label="Example icon-button with a menu"
                                                                      >
                                                                        <mat-icon
                                                                          >more_vert</mat-icon
                                                                        >
                                                                      </button>
                                                                      <mat-menu
                                                                        #maxScore="matMenu"
                                                                      >
                                                                        <button
                                                                          mat-menu-item
                                                                          (click)="
                                                                            addScoringCriteria(
                                                                              i,
                                                                              j,
                                                                              k,
                                                                              l,
                                                                              m
                                                                            )
                                                                          "
                                                                        >
                                                                          <mat-icon
                                                                            >edit</mat-icon
                                                                          >
                                                                          <span
                                                                            >Add
                                                                            Criteria</span
                                                                          >
                                                                        </button>
                                                                        <button
                                                                          [disabled]="
                                                                            getScoringCriteriaControls(
                                                                              i,
                                                                              j,
                                                                              k,
                                                                              l,
                                                                              m
                                                                            )
                                                                              .length ==
                                                                            1
                                                                              ? true
                                                                              : false
                                                                          "
                                                                          mat-menu-item
                                                                          (click)="
                                                                            removeScoringCriteria(
                                                                              i,
                                                                              j,
                                                                              k,
                                                                              l,
                                                                              m,
                                                                              n
                                                                            )
                                                                          "
                                                                        >
                                                                          <mat-icon
                                                                            >delete</mat-icon
                                                                          >
                                                                          <span
                                                                            >Delete</span
                                                                          >
                                                                        </button>
                                                                      </mat-menu>
                                                                    </td>
                                                                  </div>
                                                                </tr>
                                                              </table>
                                                            </div>
                                                          </td>
                                                        </div>
                                                      </tr>
                                                    </table>
                                                  </div>
                                                  <!-- parameter End -->
                                                </div>
                                              </tr>
                                            </table>
                                          </div>
                                          <!-- End subcategoryThree -->
                                        </div>
                                      </tr>
                                    </table>
                                  </div>
                                  <!-- subcategoryTwo End -->
                                </div>
                              </tr>
                            </table>
                          </div>
                          <!-- subcategory End-->
                          <td>
                            <button
                              class="bottun-align"
                              mat-icon-button
                              [matMenuTriggerFor]="rMenu"
                              aria-label="Example icon-button with a menu"
                            >
                              <mat-icon>more_vert</mat-icon>
                            </button>

                            <mat-menu #rMenu="matMenu">
                              <button mat-menu-item (click)="addCategory()">
                                <mat-icon>add</mat-icon>
                                <span>Add New Row</span>
                              </button>
                              <button
                                mat-menu-item
                                (click)="createCategoryCopy(i)"
                              >
                                <mat-icon>file_copy</mat-icon>
                                <span>Copy Row</span>
                              </button>
                              <button
                                [disabled]="
                                  getCategoryControls().length == 1
                                    ? true
                                    : false
                                "
                                mat-menu-item
                                (click)="removeCategory(i)"
                              >
                                <mat-icon>delete</mat-icon>
                                <span>Remove Row</span>
                              </button>
                            </mat-menu>
                          </td>
                        </div>
                      </tr>
                    </table>
                  </div>
                </p-accordionTab>
              </p-accordion>
            </tr>
          </table>
        </tbody>
      </table>
    </div>
  </form>
</div>
<p-divider></p-divider>
<button [disabled]="saveButton" pButton class="SaveButton" (click)="onSave()">
  Save
</button>
<button
  [disabled]="saveAsDraftButton"
  pButton
  (click)="onClickDraft()"
  class="SaveDraftButton"
>
  Save as Draft
</button>

<div class="card">
  <form [formGroup]="saveAsDraftForm">
    <div class="p-fluid field">
      <p-dialog
        class="userDialog"
        [(visible)]="draftDialog"
        [style]="{ width: '20%', margin: '0px 20px' }"
      >
        <ng-template pTemplate="header">
          <h2>Save as Draft</h2>
          <hr />
        </ng-template>
        
        <ng-template pTemplate="content">
          <div class="inputbox">
            <span>
              <input
                type="text"
                pInputText
                placeholder="Enter Draft Version"
                formControlName="draftVersion"
                [pattern]="draftVersionPattern"
              />

              <small
                *ngIf="
                  saveAsDraftForm.get('draftVersion')?.touched &&
                  !saveAsDraftForm.get('draftVersion')?.valid
                "
              >
                <span style="color: red">
                  Version should not contain alphabets and special characters
                </span>
                <br />
                <!-- <span style="color: red"> Accept Only Numbers. </span> -->
              </small>
            </span>
          </div>
          <div class="inputbox">
            <span>
              <input
                type="text"
                pInputText
                placeholder="Enter Draft Tag"
                formControlName="draftTag"
                required="true"
              />
              <small
                *ngIf="
                  !saveAsDraftForm.get('draftTag')?.valid &&
                  saveAsDraftForm.get('draftTag')?.touched
                "
              >
                <span style="color: red"> This field is required </span>
              </small>
            </span>
          </div>
        </ng-template>
        <ng-template pTemplate="footer">
          <button
            pButton
            class="SaveDraftButton"
            (click)="onClickSave()"
            label="Save"
            icon="pi pi-draft"
            [disabled]="saveAsDraftForm.invalid"
          ></button>
        </ng-template>
      </p-dialog>
    </div>
  </form>
</div>

<!-- Notification msg's -->
<p-toast></p-toast>
<p-confirmDialog
  header="Confirmation"
  icon="pi pi-exclamation-triangle"
></p-confirmDialog>
